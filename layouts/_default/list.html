{{ define "main" }}
<div class="blog-container">
  <h1 class="page-title">{{ .Title }}</h1>

  <div class="post-stream">
    {{ range .Pages }}
	{{ $post := . }} <!-- Save so it can be accessed within cover -->
    <article class="post-preview">
      <header>
        <h2 class="entry-title">
          <a href="{{ .Permalink }}">{{ .Title }}</a>
        </h2>
        <div class="entry-meta">
          <span class="date">{{ .Date.Format "January 2, 2006" }}</span>
          <span class="separator">•</span>
          <span class="read-time">{{ .ReadingTime }} min read</span>
        </div>
      </header>

      {{ with .Params.cover }}
      <div class="entry-cover">
        <a href="{{ $post.Permalink }}">
          <img src="{{ . }}" alt="Cover for {{ $post.Title }}" loading="lazy" />
        </a>
      </div>
      {{ end }}

      <div class="entry-summary">
        <p>{{ .Summary | plainify | truncate 300 }}</p>
        <a class="read-more" href="{{ .Permalink }}">Read More →</a>
      </div>

      {{ with .Params.tags }}
      <div class="entry-tags">
        {{ range . }}
        <a href="/tags/{{ . | urlize }}" class="tag-pill">#{{ . }}</a>
        {{ end }}
      </div>
      {{ end }}
    </article>
    {{ end }}
  </div>
</div>
{{ end }}
